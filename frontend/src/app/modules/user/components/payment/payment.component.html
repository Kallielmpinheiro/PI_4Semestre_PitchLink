<div class="min-h-screen bg-gradient-to-br from-gray-900 via-gray-800 to-gray-900 py-12 px-4 sm:px-6 lg:px-8 text-gray-200">
  <div class="max-w-7xl mx-auto">
    
    <!-- Header -->
    <div class="text-center mb-16">
      <h1 class="text-4xl md:text-6xl font-bold text-white mb-6">
        Planos de <span class="text-transparent bg-clip-text bg-gradient-to-r from-blue-600 to-purple-600">Assinatura</span>
      </h1>
      <p class="text-xl text-gray-300 mb-8 max-w-3xl mx-auto leading-relaxed">
        Escolha o melhor plano para impulsionar suas inovações e transformar suas ideias em realidade
      </p>
      
      <!-- Current Plan Badge -->
      <div class="inline-flex items-center px-6 py-3 rounded-full bg-gray-800/80 shadow-lg border border-gray-700 backdrop-blur-sm">
        <span class="text-sm text-gray-300 mr-3">Plano atual:</span>
        <span class="inline-flex items-center px-4 py-2 rounded-full text-sm font-semibold bg-gradient-to-r from-green-700 to-emerald-700 text-green-200 border border-green-600">
          <div class="w-2 h-2 bg-green-400 rounded-full mr-2 animate-pulse"></div>
          {{ getPlanDisplayName(currentPlan) }}
        </span>
      </div>
    </div>


    <!-- Messages -->
    <div *ngIf="successMessage" class="mb-8 max-w-md mx-auto">
      <div class="flex items-center p-4 mb-4 text-sm text-green-200 border border-green-600 rounded-lg bg-green-900/20" role="alert">
        <svg class="flex-shrink-0 inline w-4 h-4 mr-3" aria-hidden="true" fill="currentColor" viewBox="0 0 20 20">
          <path d="M10 .5a9.5 9.5 0 1 0 9.5 9.5A9.51 9.51 0 0 0 10 .5ZM9.5 4a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3ZM12 15H8a1 1 0 0 1 0-2h1v-3H8a1 1 0 0 1 0-2h2a1 1 0 0 1 1 1v4h1a1 1 0 0 1 0 2Z"/>
        </svg>
        <span class="sr-only">Sucesso</span>
        <div>{{ successMessage }}</div>
      </div>
    </div>

    <div *ngIf="errorMessage" class="mb-8 max-w-md mx-auto">
      <div class="flex items-center p-4 mb-4 text-sm text-red-200 border border-red-600 rounded-lg bg-red-900/20" role="alert">
        <svg class="flex-shrink-0 inline w-4 h-4 mr-3" aria-hidden="true" fill="currentColor" viewBox="0 0 20 20">
          <path d="M10 .5a9.5 9.5 0 1 0 9.5 9.5A9.51 9.51 0 0 0 10 .5ZM9.5 4a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3ZM12 15H8a1 1 0 0 1 0-2h1v-3H8a1 1 0 0 1 0-2h2a1 1 0 0 1 1 1v4h1a1 1 0 0 1 0 2Z"/>
        </svg>
        <span class="sr-only">Erro</span>
        <div>{{ errorMessage }}</div>
      </div>
    </div>

    <!-- Loading -->
    <div *ngIf="loading" class="flex justify-center items-center py-20">
      <div class="text-center">
        <div role="status">
          <svg aria-hidden="true" class="inline w-12 h-12 mr-2 text-gray-700 animate-spin fill-blue-500" viewBox="0 0 100 101" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M100 50.5908C100 78.2051 77.6142 100.591 50 100.591C22.3858 100.591 0 78.2051 0 50.5908C0 22.9766 22.3858 0.59082 50 0.59082C77.6142 0.59082 100 22.9766 100 50.5908ZM9.08144 50.5908C9.08144 73.1895 27.4013 91.5094 50 91.5094C72.5987 91.5094 90.9186 73.1895 90.9186 50.5908C90.9186 27.9921 72.5987 9.67226 50 9.67226C27.4013 9.67226 9.08144 27.9921 9.08144 50.5908Z" fill="currentColor"/>
            <path d="m93.9676 39.0409c1.3069 5.77 1.9935 11.7888 1.9935 17.9409 0 5.3357-2.5589 10.3718-6.5896 13.1749l-2.7158-6.0079c2.6924-1.7654 4.3024-4.8275 4.3024-8.1670 0-3.3885-1.6590-6.5076-4.4524-8.3010l2.9619-8.0998z" fill="currentFill"/>
          </svg>
          <span class="sr-only">Carregando...</span>
        </div>
        <p class="text-gray-300 mt-4 text-lg">Carregando planos...</p>
      </div>
    </div>

    <!-- Plans Grid -->
    <div *ngIf="!loading" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 max-w-6xl mx-auto">
      <div *ngFor="let plan of plans"
          class="relative bg-white dark:bg-gray-800 rounded-3xl shadow-xl border border-gray-200 dark:border-gray-700 overflow-hidden transition-all duration-500 hover:shadow-2xl hover:-translate-y-2 group"
          [class.ring-2]="plan.popular"
          [class.ring-blue-500]="plan.popular"
          [class.scale-105]="plan.popular"
          [class.z-10]="plan.popular">
        
        <!-- Popular Badge -->
        <div *ngIf="plan.popular" class="absolute -top-3 left-1/2 transform -translate-x-1/2 z-20">
          <span class="inline-flex items-center px-4 py-2 rounded-full text-sm font-bold bg-gradient-to-r from-blue-600 to-purple-600 text-white shadow-xl">
            <svg class="w-4 h-4 mr-2" fill="currentColor" viewBox="0 0 20 20">
              <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"/>
            </svg>
            Mais Popular
          </span>
        </div>

        <div class="p-8 pt-10">
          <!-- Plan Header -->
          <div class="text-center mb-8">
            <h3 class="text-2xl font-bold text-gray-900 dark:text-white mb-4">{{ plan.name }}</h3>
            <div class="flex items-baseline justify-center mb-6">
              <span class="text-5xl font-bold text-gray-900 dark:text-white">{{ formatCurrency(plan.price) }}</span>
              <span class="text-gray-500 dark:text-gray-300 ml-2 text-lg">/mês</span>
            </div>
          </div>
          
          <!-- Features -->
          <ul class="space-y-4 mb-10">
            <li *ngFor="let feature of plan.features" class="flex items-center">
              <div class="flex-shrink-0 mr-3">
                <svg class="w-5 h-5 text-green-500" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/>
                </svg>
              </div>
              <span class="text-gray-700 dark:text-gray-300 text-sm">{{ feature }}</span>
            </li>
          </ul>

          <!-- Action Button -->
          <div class="mt-auto">
            <button 
              *ngIf="currentPlan !== plan.id"
              type="button"
              class="w-full text-white font-bold rounded-2xl text-base px-6 py-4 text-center transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed shadow-lg hover:shadow-xl"
              [class]="plan.popular ? 
                'bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700' : 
                'bg-gradient-to-r from-gray-600 to-gray-700 hover:from-gray-700 hover:to-gray-800'"
              [disabled]="processingPayment"
              (click)="selectPlan(plan.id)">
              
              <div *ngIf="processingPayment && selectedPlan === plan.id" class="flex items-center justify-center">
                <svg aria-hidden="true" class="w-5 h-5 mr-3 text-white animate-spin" viewBox="0 0 100 101" fill="none">
                  <path d="M100 50.5908C100 78.2051 77.6142 100.591 50 100.591C22.3858 100.591 0 78.2051 0 50.5908C0 22.9766 22.3858 0.59082 50 0.59082C77.6142 0.59082 100 22.9766 100 50.5908ZM9.08144 50.5908C9.08144 73.1895 27.4013 91.5094 50 91.5094C72.5987 91.5094 90.9186 73.1895 90.9186 50.5908C90.9186 27.9921 72.5987 9.67226 50 9.67226C27.4013 9.67226 9.08144 27.9921 9.08144 50.5908Z" fill="currentColor"/>
                  <path d="m93.9676 39.0409c1.3069 5.77 1.9935 11.7888 1.9935 17.9409 0 5.3357-2.5589 10.3718-6.5896 13.1749l-2.7158-6.0079c2.6924-1.7654 4.3024-4.8275 4.3024-8.1670 0-3.3885-1.6590-6.5076-4.4524-8.3010l2.9619-8.0998z" fill="currentFill"/>
                </svg>
                Processando...
              </div>
              
              <span *ngIf="!(processingPayment && selectedPlan === plan.id)">
                Escolher Plano
              </span>
            </button>

            <div *ngIf="currentPlan === plan.id" class="text-center">
              <div class="inline-flex items-center px-6 py-3 rounded-2xl text-sm font-bold bg-gradient-to-r from-green-100 to-emerald-100 dark:from-green-900 dark:to-emerald-900 text-green-800 dark:text-green-200 border-2 border-green-200 dark:border-green-700 shadow-lg">
                <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/>
                </svg>
                Plano Atual
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>


    <!-- Payment Modal -->
    <div *ngIf="selectedPlan" 
         class="fixed inset-0 z-50 flex items-center justify-center p-4"
         aria-labelledby="modal-title" 
         role="dialog" 
         aria-modal="true">
      
      <!-- Background overlay with blur -->
      <div class="absolute inset-0 bg-gray-900 bg-opacity-80 backdrop-blur-md transition-all duration-300" 
           (click)="cancelPlan()"></div>

      <!-- Modal panel -->
      <div class="relative bg-white dark:bg-gray-900 rounded-3xl shadow-2xl w-full max-w-lg mx-auto overflow-hidden transform transition-all duration-300 scale-100">
        
        <!-- Modal Header -->
        <div class="relative bg-gradient-to-r from-blue-600 via-purple-600 to-indigo-600 px-6 py-6">
          <div class="flex items-center justify-between">
            <div class="flex items-center space-x-3">
              <div class="flex items-center justify-center h-12 w-12 rounded-full bg-white bg-opacity-20 backdrop-blur-sm">
                <svg class="h-6 w-6 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"/>
                </svg>
              </div>
              <div>
                <h3 class="text-xl font-bold text-white">Finalizar Pagamento</h3>
                <p class="text-blue-100">{{ getPlanDisplayName(selectedPlan) }}</p>
              </div>
            </div>

            <!-- Close button -->
            <button 
              type="button"
              class="rounded-full p-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-200"
              (click)="cancelPlan()"
              [disabled]="processingPayment">
              <svg class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
              </svg>
            </button>
          </div>
        </div>

        <!-- Modal Body -->
        <div class="px-6 py-6">
          <!-- Price Display -->
          <div class="bg-gradient-to-br from-blue-900 to-purple-900 border border-blue-900 rounded-2xl p-6 mb-6 text-center">
            <div class="text-3xl font-bold text-gray-100 mb-1">
              {{ formatCurrency(getSelectedPlanPrice()) }}
            </div>
            <div class="text-gray-300">por mês</div>
            <div class="text-xs text-gray-400 mt-1">Cobrança recorrente mensal</div>
          </div>

          <!-- Card Input -->
          <div class="mb-6">
            <label class="block text-sm font-bold text-gray-200 mb-3">
              Dados do Cartão
            </label>
            <div class="relative">
              <div id="card-element" 
                  class="text-white block w-full px-4 py-4 border-2 border-gray-700 rounded-xl shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-gray-800">
              </div>
            </div>
          </div>

          <!-- Security Info -->
          <div class="bg-blue-50 dark:bg-blue-950 border border-blue-200 dark:border-blue-800 rounded-xl p-4 mb-6">
            <div class="flex items-center space-x-3">
              <div class="flex-shrink-0">
                <svg class="h-5 w-5 text-blue-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"/>
                </svg>
              </div>
              <div>
                <p class="text-sm font-bold text-blue-900 dark:text-blue-300 mb-1">
                  Pagamento 100% Seguro
                </p>
                <p class="text-xs text-blue-700 dark:text-blue-400">
                  Processado pelo Stripe com criptografia SSL de 256 bits
                </p>
              </div>
            </div>
          </div>

          <!-- Terms -->
          <div class="text-xs text-gray-600 dark:text-gray-300 mb-6 text-center bg-gray-50 dark:bg-gray-800 rounded-xl p-3">
            Ao confirmar o pagamento, você concorda com nossos 
            <a href="#" class="text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 font-semibold hover:underline transition-colors">Termos de Uso</a> e 
            <a href="#" class="text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 font-semibold hover:underline transition-colors">Política de Privacidade</a>
          </div>
        </div>

        <!-- Modal Footer -->
        <div class="bg-gray-50 dark:bg-gray-800 px-6 py-4 flex space-x-3">
          <button 
            type="button"
            class="flex-1 bg-white dark:bg-gray-900 py-3 px-4 border-2 border-gray-300 dark:border-gray-600 rounded-xl text-sm font-bold text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-700 hover:border-gray-400 dark:hover:border-gray-500 focus:outline-none focus:ring-2 focus:ring-gray-200 dark:focus:ring-gray-600 disabled:opacity-50 transition-all duration-200 shadow-sm"
            (click)="cancelPlan()"
            [disabled]="processingPayment">
            Cancelar
          </button>
          
          <button 
            type="button"
            class="flex-1 bg-gradient-to-r from-blue-600 to-purple-600 py-3 px-4 border border-transparent rounded-xl text-sm font-bold text-white hover:from-blue-700 hover:to-purple-700 focus:outline-none focus:ring-2 focus:ring-blue-300 disabled:opacity-50 shadow-lg transition-all duration-200"
            (click)="processPayment()"
            [disabled]="processingPayment">
            
            <div *ngIf="processingPayment" class="flex items-center justify-center">
              <svg aria-hidden="true" class="w-4 h-4 mr-2 text-white animate-spin" viewBox="0 0 100 101" fill="none">
                <path d="M100 50.5908C100 78.2051 77.6142 100.591 50 100.591C22.3858 100.591 0 78.2051 0 50.5908C0 22.9766 22.3858 0.59082 50 0.59082C77.6142 0.59082 100 22.9766 100 50.5908ZM9.08144 50.5908C9.08144 73.1895 27.4013 91.5094 50 91.5094C72.5987 91.5094 90.9186 73.1895 90.9186 50.5908C90.9186 27.9921 72.5987 9.67226 50 9.67226C27.4013 9.67226 9.08144 27.9921 9.08144 50.5908Z" fill="currentColor"/>
                <path d="m93.9676 39.0409c1.3069 5.77 1.9935 11.7888 1.9935 17.9409 0 5.3357-2.5589 10.3718-6.5896 13.1749l-2.7158-6.0079c2.6924-1.7654 4.3024-4.8275 4.3024-8.1670 0-3.3885-1.6590-6.5076-4.4524-8.3010l2.9619-8.0998z" fill="currentFill"/>
              </svg>
              Processando...
            </div>
            
            <div *ngIf="!processingPayment" class="flex items-center justify-center">
              <svg class="w-4 h-4 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"/>
              </svg>
              Confirmar Pagamento
            </div>
          </button>
        </div>
      </div>
    </div>
  </div>
</div>